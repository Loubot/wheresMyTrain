// Generated by CoffeeScript 1.6.3
(function() {
  window.init = function() {
    var allTrains, populatePage, trainsStorer;
    console.log('begin');
    allTrains = (function() {
      function allTrains() {
        this.trainsInfo = [];
      }

      allTrains.prototype.storeTrains = function(code, train) {
        return this.trainsInfo[code] = train;
      };

      allTrains.prototype.getTrain = function(code) {
        return this.trainsInfo[code];
      };

      return allTrains;

    })();
    window.getTrainInfo = function(type) {
      return $.ajax({
        type: 'get',
        data: {
          data: type
        },
        url: 'http://10.0.2.2:3000/all_stations.json',
        dataType: 'json',
        success: function(json) {
          populatePage(json);
          return console.log('success');
        },
        error: function(error) {
          alert('shite ' + JSON.stringify(error));
          return console.log('error');
        }
      });
    };
    getTrainInfo('A');
    trainsStorer = new allTrains();
    populatePage = function(json) {
      $('#trainInfo').empty();
      return $(json).each(function() {
        $('#trainInfo').append("<a href='#' onclick=\"showMe('" + this.code + "')\">" + this.desc + "</a><br>");
        return trainsStorer.storeTrains(this.code, this);
      });
    };
    return window.showMe = function(code) {
      window.sessionStorage.setItem('trainInfo', JSON.stringify(trainsStorer.getTrain(code)));
      console.log('trainInfo' + window.sessionStorage.getItem('trainInfo'));
      return $.mobile.changePage('../displayTrain/displayTrain.html', {
        transition: 'pop',
        changeHash: 'true'
      });
    };
  };

}).call(this);
