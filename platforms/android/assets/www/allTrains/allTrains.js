// Generated by CoffeeScript 1.6.3
(function() {
  $(document).on('pagebeforeshow', '#all_trains_page', function() {
    var allTrains, populatePage, trainsStorer;
    console.log('begin');
    allTrains = (function() {
      function allTrains() {
        this.trainsInfo = [];
      }

      allTrains.prototype.storeTrains = function(code, train) {
        return this.trainsInfo[code] = train;
      };

      allTrains.prototype.getTrain = function(code) {
        return this.trainsInfo[code];
      };

      return allTrains;

    })();
    window.getTrainInfo = function(type) {
      return $.ajax({
        type: 'get',
        data: {
          data: type
        },
        url: 'http://10.0.2.2:3000/all_trains.json',
        dataType: 'json',
        success: function(json) {
          populatePage(json);
          return console.log('success');
        },
        error: function(error) {
          return console.log('shite ' + JSON.stringify(error));
        }
      });
    };
    getTrainInfo('A');
    trainsStorer = new allTrains();
    return populatePage = function(json) {
      $('#trainInfo').empty();
      return $(json).each(function() {
        $('#trainInfo').append("<a href='#' onclick=\"showMe('" + this.code + "')\">" + this.desc + "</a><hr>");
        return trainsStorer.storeTrains(this.code, this);
      });
    };
  });

  window.showMe = function(code) {
    window.sessionStorage.setItem('trainInfo', JSON.stringify(trainsStorer.getTrain(code)));
    console.log('trainInfo' + window.sessionStorage.getItem('trainInfo'));
    return $.mobile.changePage('../displayTrain/displayTrain.html', {
      transition: 'slide',
      changeHash: 'true'
    });
  };

}).call(this);
